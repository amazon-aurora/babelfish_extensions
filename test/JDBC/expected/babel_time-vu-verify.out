-- psql
-- behaviour of casting to time in psql
SELECT CAST('2012-02-23' AS TIME)
GO
~~ERROR (Code: 0)~~

~~ERROR (Message: ERROR: invalid input syntax for type time: "2012-02-23"
  Position: 53
    Server SQLState: 22007)~~


-- tsql
-- if only date is given as input
-- accepted formats are `mm{-/.}dd{-/.}yyyy`, `yyyy{-/.}mm{-/.}dd`
-- If text month is given then acceptable formats are `dd{-/.}Mon{-/.}yyyy`, `yyyy{-/.}Mon{-/.}dd`
SELECT CAST('   23   -     11   -   2000   ' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('23-2000-11' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('11-2000-23' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('11-23-2000' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('2000-11-23' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('2000-23-11' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('     23     /       11    /     2000     ' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('23/2000/11' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('11/2000/23' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('11/23/2000' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('2000/11/23' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('2000/23/11' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST(' 23   -     Nov    -      2000 ' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('23-2000-Nov' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


-- Need handling(was failing in SQL Server)
SELECT CAST('Nov-2000-23' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


-- Need handling(was failing in SQL Server)
SELECT CAST('Nov-23-2000' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('2000-Nov-23' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('2000-23-Nov' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('  23    /   Nov    /    2000   ' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('23/2000/Nov' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


-- Need handling(was failing in SQL Server)
SELECT CAST('Nov/2000/23' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


-- Need handling(was failing in SQL Server)
SELECT CAST('Nov/23/2000' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('2000/Nov/23' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('2000/23/Nov' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('23        .        11      .     2000' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('23.2000.11' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('11.2000.23' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('11.23.2000' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('2000.11.23' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('2000.23.11' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('   23   . Nov  .  2000  ' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('23.2000.Nov' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


-- Need handling(was failing in SQL Server)
SELECT CAST('Nov.2000.23' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


-- Need handling(was failing in SQL Server)
SELECT CAST('Nov.23.2000' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('2000.Nov.23' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('2000.23.Nov' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


-- If numeric is specified
-- If `am` or `pm` is specified
SELECT CAST('1' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('10' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('102' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~



-- need handling
-- SELECT CAST('1020' AS TIME)
-- GO
SELECT CAST('10202' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~



-- need handling
-- SELECT CAST('102022' AS TIME)
-- GO
SELECT CAST('1010101' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~



-- need handling
-- SELECT CAST('10101010' AS TIME)
-- GO
SELECT CAST('101010101' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('01 Am' AS TIME)
GO
~~START~~
time
01:00:00.0000000
~~END~~


SELECT CAST('Am 01' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('13 Am' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('01 Pm' AS TIME)
GO
~~START~~
time
13:00:00.0000000
~~END~~


SELECT CAST('24 Pm' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('11:58:59 Pm' AS TIME)
GO
~~START~~
time
23:58:59.0000000
~~END~~


SELECT CAST('2000-11-23 Am' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('2000-11-23 11:58:59 Pm' AS TIME)
GO
~~START~~
time
23:58:59.0000000
~~END~~


-- different kind of input
SELECT CAST('1998-02-23T14:23:05' AS time)
GO
~~START~~
time
14:23:05.0000000
~~END~~


SELECT CAST('1998-02-23num14:23:05' AS time)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('12 jan 20 2:3' AS TIME)
GO
~~START~~
time
02:03:00.0000000
~~END~~


SELECT CAST('12 decemBer 20 2:3' AS TIME)
GO
~~START~~
time
02:03:00.0000000
~~END~~


SELECT CAST('jan  12 20 2:3' AS TIME)
GO
~~START~~
time
02:03:00.0000000
~~END~~


SELECT CAST('jan 2012 12 2:3' AS TIME)
GO
~~START~~
time
02:03:00.0000000
~~END~~


-- casting to particular round off, valid in range of [0-7]
SELECT CAST('2015-03-19 01:05:06.289' AS TIME(0))
GO
~~START~~
time
01:05:06
~~END~~


SELECT CAST('2015-03-19 01:05:06.289' AS TIME(1))
GO
~~START~~
time
01:05:06.3
~~END~~


SELECT CAST('2015-03-19 01:05:06.289' AS TIME(2))
GO
~~START~~
time
01:05:06.29
~~END~~


SELECT CAST('2015-03-19 01:05:06.289' AS TIME(3))
GO
~~START~~
time
01:05:06.289
~~END~~


SELECT CAST('2015-03-19 01:05:06.289' AS TIME(4))
GO
~~START~~
time
01:05:06.2890
~~END~~


SELECT CAST('2015-03-19 01:05:06.289' AS TIME(5))
GO
~~START~~
time
01:05:06.28900
~~END~~


SELECT CAST('2015-03-19 01:05:06.289' AS TIME(6))
GO
~~START~~
time
01:05:06.289000
~~END~~


SELECT CAST('2015-03-19 01:05:06.289' AS TIME(7))
GO
~~START~~
time
01:05:06.289000
~~END~~


-- multiple casting
SELECT CAST(CAST('2000-11-23' AS DATETIME) AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


select CAST(CAST('00:00:00.000' AS time) AS datetime)
go
~~START~~
datetime
1900-01-01 00:00:00.0
~~END~~


select CAST(CAST('2000-11-23' AS time) AS datetime)
go
~~START~~
datetime
1900-01-01 00:00:00.0
~~END~~

select CAST(CAST('23:59:59.123456' AS time) AS datetime)
go
~~START~~
datetime
1900-01-01 23:59:59.123
~~END~~


select CAST(CAST('1900-05-06 23:59:29.998' AS datetime) AS time)
go
~~START~~
time
23:59:29.9980000
~~END~~


select CAST(CAST('2050-05-06 00:00:00' AS datetime) AS time)
go
~~START~~
time
00:00:00.0000000
~~END~~


select CAST(CAST('2050-05-06 23:59:29.998' AS datetime) AS time)
go
~~START~~
time
23:59:29.9980000
~~END~~


-- These particular cases are failing in SQL Server but passing in bbf
-- case where if we mention input has no milli seconds mentioned after (".")
-- and cases when valid offset("+-") and for valid range
SELECT CAST('2012   -    02   -    23     2    :      3       :       8    .' AS TIME)
GO
~~START~~
time
02:03:08.0000000
~~END~~


SELECT CAST('2012   -    02   -    23     2    :      3       :       8    .' AS TIME(0))
GO
~~START~~
time
02:03:08
~~END~~


SELECT CAST('2012   -    02   -    23     2    :      3       :       8    .          876    +   8' AS TIME)
GO
~~START~~
time
02:03:08.8760000
~~END~~


SELECT CAST('2012   -    02   -    23     2    :      3       :       8    .          876    -   8' AS TIME)
GO
~~START~~
time
02:03:08.8760000
~~END~~


SELECT CAST('2012   -    02   -    23     2    :      3       :       8    .          876    +   8' AS TIME(0))
GO
~~START~~
time
02:03:09
~~END~~


SELECT CAST('2012   -    02   -    23     2    :      3       :       8    .          876    -   8' AS TIME(0))
GO
~~START~~
time
02:03:09
~~END~~


SELECT CAST('2012-      02-     23     02      :     03  :     00        +       8' AS TIME)
GO
~~START~~
time
02:03:00.0000000
~~END~~


SELECT CAST('2012   -    FeB   -    23     2    :      3       :       8    .' AS TIME)
GO
~~START~~
time
02:03:08.0000000
~~END~~


SELECT CAST('2012   -    FeB   -    23     2    :      3       :       8    .' AS TIME(0))
GO
~~START~~
time
02:03:08
~~END~~


SELECT CAST('2012   -    FeB   -    23     2    :      3       :       8    .          876   + 8' AS TIME)
GO
~~START~~
time
02:03:08.8760000
~~END~~


SELECT CAST('2012   -    FeB   -    23     2    :      3       :       8    .          876   - 8' AS TIME)
GO
~~START~~
time
02:03:08.8760000
~~END~~


SELECT CAST('2012   -    FeB   -    23     2    :      3       :       8    .          876   + 8' AS TIME(0))
GO
~~START~~
time
02:03:09
~~END~~


SELECT CAST('2012   -    FeB   -    23     2    :      3       :       8    .          876   - 8' AS TIME(0))
GO
~~START~~
time
02:03:09
~~END~~


-- case for different types of date format(mm-dd-yyyy, mm-yyyy-dd)
SELECT CAST('Jan-01-2001' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('Jan-01-2001 01:05:06.289' AS TIME)
GO
~~START~~
time
01:05:06.2890000
~~END~~


SELECT CAST('Jan-2021-01' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('Jan-2021-01 01:05:06.289' AS TIME)
GO
~~START~~
time
01:05:06.2890000
~~END~~


-- case where input is of format 'mm yyyy dd hhmmss.ss'
SELECT CAST('Jan   2021   01 010506.289' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


-- if input is given in hhmmss
SELECT CAST('121200' AS TIME)
GO
~~START~~
time
12:12:00.0000000
~~END~~


SELECT CAST('001200' AS TIME)
GO
~~START~~
time
00:12:00.0000000
~~END~~


SELECT CAST('0012:00' AS TIME)
GO
~~START~~
time
12:00:00.0000000
~~END~~


-- Negative cases
-- if only offset is mentioned
SELECT CAST('+02' AS TIME);
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


-- Invalid dates has been passed as an input
SELECT CAST('Jan-0000-01' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('Jan-2021-34' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('Month-2021-01' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


-- casting to time from date shouldn't be allowed
select CAST(CAST('2020-03-15' AS date) AS time);
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: cannot cast type date to time without time zone)~~


-- out of range for time datatype should throw error
SELECT CAST('2015-03-19 01:05:06.   289' AS TIME(8))
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Specified scale 8 is invalid. 'time' datatype must have scale between 0 and 7)~~


-- case where the yyyy is not able to figure out from given input which contains yy
SELECT CAST('3-01-jan 01:05:06.289' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


-- if given hh:mmmm
SELECT CAST('00:1200' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


--if given yyyymmdd as input
SELECT CAST('2012jan01' AS TIME)
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT CAST('Jan   2021    010506.289' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('Jan   2021   01 01   05    06    .    289' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


-- if only offset is mentioned
SELECT CAST('+02' AS TIME);
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


-- if invalid dates has been given then conversion shouldn't succeed
SELECT CAST('0000-00-00' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('0-0-0' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('00-00-0000' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('00-0-0' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


SELECT CAST('0-0-00' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Conversion failed when converting date and/or time from character string.)~~


-- need to check
SELECT CAST('Jan-2021-01 121200 ' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: time zone "jan-2021-01" not recognized)~~


SELECT CAST('Jan-2021-01 121200 -1' AS TIME)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: time zone "jan-2021-01" not recognized)~~


SELECT * from babel_TIME_vu_prepare_t1
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT babel_TIME_vu_prepare_f1()
GO
~~START~~
time
00:00:00.0000000
~~END~~


exec babel_TIME_vu_prepare_p1
GO
~~START~~
time
00:00:00.0000000
~~END~~


SELECT * FROM babel_TIME_vu_prepare_v1
GO
~~START~~
time
00:00:00.0000000
~~END~~

