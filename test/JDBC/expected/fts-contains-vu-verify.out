-- tsql user=jdbc_user password=12345678
-- enable FULLTEXT
SELECT set_config('babelfishpg_tsql.escape_hatch_fulltext', 'ignore', 'false')
GO
~~START~~
text
ignore
~~END~~


-- Test sys.babelfish_fts_contains_pgconfig
SELECT * FROM fts_contains_pgconfig_v1
GO
~~START~~
text
fts_contains_simple
~~END~~




-- Full syntax of CONTAINS: https://github.com/MicrosoftDocs/sql-docs/blob/live/docs/t-sql/queries/contains-transact-sql.md
-- test basic CONTAINS use: ... CONTAINS(col_name, <simple_term>) ...
-- <simple_term> ::= { word | "phrase" }
-- tab character in search string
EXEC fts_contains_vu_prepare_p1 '"due	to"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


-- line break
EXEC fts_contains_vu_prepare_p1 '"due
to"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


-- no-break space character
declare @my_str varchar(50) = '"due'+char(160)+'to"';
EXEC fts_contains_vu_prepare_p1 @my_str
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1("varchar") does not exist)~~


EXEC fts_contains_vu_prepare_p1 '天'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 N'שלום'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(nvarchar) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"one 天 two"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 'Tópicos'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '天'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


SELECT sys.babelfish_fts_rewrite('"one''two"')
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Full Text Search is not currently supported in Babelfish.)~~


SELECT sys.babelfish_fts_rewrite('"one`two"')
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Full Text Search is not currently supported in Babelfish.)~~


-- colons, semicolons, pipes, parenthesis, etc.
EXEC fts_contains_vu_prepare_p1 '"one : two"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"one :)"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 'one;two'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 'one|two'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"one (two)"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"one * two"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"one<two"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"one&two"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"one~two"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"one|two"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"one$two"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 'love'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


-- Case sensitive tests
EXEC fts_contains_vu_prepare_p1 'LOVE'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 'Love'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


-- Test for empty string input, should throw error
EXEC fts_contains_vu_prepare_p1 ''
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


-- Test for empty string input, should throw error
EXEC fts_contains_vu_prepare_p1 '            '
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


-- Test for empty string input, should throw error
EXEC fts_contains_vu_prepare_p1 NULL
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '  "" '
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '  ""'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"" '
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '" "'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 'other'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 'arts'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 'performing'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 'performance'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 'quick'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 'grow'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 'actually'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 'helped'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 'version'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"come       back"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"  come          back    "'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"much of the"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"due to"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"per cent"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"so-called"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~



EXEC fts_contains_vu_prepare_p1 '"stand up"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"every month"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"as a result"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"in Australia"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"daily news"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '" daily"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"daily "'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 ' "daily news"'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"daily news" '
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


-- Transactionality test
BEGIN TRANSACTION;
EXEC fts_contains_vu_prepare_p1 '   "  daily news            " '
COMMIT TRANSACTION;
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


-- Prefix Term not supported
EXEC fts_contains_vu_prepare_p1 '"conf*"', 20
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown, integer) does not exist)~~


EXEC fts_contains_vu_prepare_p1 '"conf      *"', 20
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown, integer) does not exist)~~


-- Generation Term not supported
EXEC fts_contains_vu_prepare_p1 'FORMSOF(THESAURUS, love)'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


-- Boolean operators not supported
EXEC fts_contains_vu_prepare_p1 '"test" AND "love"';
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


EXEC fts_contains_vu_prepare_p1 'test AND love';
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: procedure fts_contains_vu_prepare_p1(unknown) does not exist)~~


-- disable FULLTEXT
SELECT set_config('babelfishpg_tsql.escape_hatch_fulltext', 'strict', 'false')
GO
~~START~~
text
strict
~~END~~

