-- DATETIME cases
SELECT * FROM babel_4214_datetime_to_int_view
GO
~~START~~
int
10
~~END~~


EXEC babel_4214_datetime_to_int_proc
GO
~~START~~
int
10
~~END~~


SELECT babel_4214_datetime_to_int_function()
GO
~~START~~
int
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS DATETIME) AS BIT);
GO
~~START~~
bit
1
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS DATETIME) AS TINYINT);
GO
~~START~~
tinyint
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS DATETIME) AS INT);
GO
~~START~~
int
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS DATETIME) AS BIGINT);
GO
~~START~~
bigint
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS DATETIME) AS FLOAT);
GO
~~START~~
float
9.539467592592592
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS DATETIME) AS DOUBLE PRECISION);
GO
~~START~~
float
9.539467592592592
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS DATETIME) AS NUMERIC(18,4));
GO
~~START~~
numeric
9.5395
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS DATETIME) AS NUMERIC(18,6));
GO
~~START~~
numeric
9.539468
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS DATETIME) AS DECIMAL);
GO
~~START~~
numeric
10
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS DATETIME) AS BIT);
GO
~~START~~
bit
1
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS DATETIME) AS TINYINT);
GO
~~START~~
tinyint
~~ERROR (Code: 220)~~

~~ERROR (Message: value for domain tinyint violates check constraint "tinyint_check")~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS DATETIME) AS INT);
GO
~~START~~
int
44926
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS DATETIME) AS BIGINT);
GO
~~START~~
bigint
44926
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS DATETIME) AS FLOAT);
GO
~~START~~
float
44925.53946759259
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS DATETIME) AS DOUBLE PRECISION);
GO
~~START~~
float
44925.53946759259
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS DATETIME) AS NUMERIC(18,4));
GO
~~START~~
numeric
44925.5395
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS DATETIME) AS NUMERIC(18,6));
GO
~~START~~
numeric
44925.539468
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS DATETIME) AS DECIMAL);
GO
~~START~~
numeric
44926
~~END~~



-- Negative dates, i.e. dates before 1900-01-01
SELECT CAST(CAST('1890-01-01 12:56:50.675' AS DATETIME) AS BIT);
GO
~~START~~
bit
1
~~END~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS DATETIME) AS TINYINT);
GO
~~START~~
tinyint
~~ERROR (Code: 220)~~

~~ERROR (Message: value for domain tinyint violates check constraint "tinyint_check")~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS DATETIME) AS INT);
GO
~~START~~
int
-3651
~~END~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS DATETIME) AS BIGINT);
GO
~~START~~
bigint
-3651
~~END~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS DATETIME) AS FLOAT);
GO
~~START~~
float
-3651.4605208333332
~~END~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS DATETIME) AS DOUBLE PRECISION);
GO
~~START~~
float
-3651.4605208333332
~~END~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS DATETIME) AS NUMERIC(18,4));
GO
~~START~~
numeric
-3651.4605
~~END~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS DATETIME) AS NUMERIC(18,6));
GO
~~START~~
numeric
-3651.460521
~~END~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS DATETIME) AS DECIMAL);
GO
~~START~~
numeric
-3651
~~END~~



-- SMALLDATETIME cases
SELECT * FROM babel_4214_smalldatetime_to_int_view
GO
~~START~~
int
10
~~END~~


EXEC babel_4214_smalldatetime_to_int_proc
GO
~~START~~
int
10
~~END~~


SELECT babel_4214_smalldatetime_to_int_function()
GO
~~START~~
int
10
~~END~~

SELECT CAST(CAST('1900-01-10 12:56:50.675' AS SMALLDATETIME) AS BIT);
GO
~~START~~
bit
1
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS SMALLDATETIME) AS TINYINT);
GO
~~START~~
tinyint
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS SMALLDATETIME) AS INT);
GO
~~START~~
int
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS SMALLDATETIME) AS BIGINT);
GO
~~START~~
bigint
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS SMALLDATETIME) AS FLOAT);
GO
~~START~~
float
9.539583333333333
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS SMALLDATETIME) AS DOUBLE PRECISION);
GO
~~START~~
float
9.539583333333333
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS SMALLDATETIME) AS NUMERIC(18,4));
GO
~~START~~
numeric
9.5396
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS SMALLDATETIME) AS NUMERIC(18,6));
GO
~~START~~
numeric
9.539583
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS SMALLDATETIME) AS NUMERIC(18,10));
GO
~~START~~
numeric
9.5395833333
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS SMALLDATETIME) AS DECIMAL);
GO
~~START~~
numeric
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.675' AS SMALLDATETIME) AS DECIMAL(18,5));
GO
~~START~~
numeric
9.53958
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS SMALLDATETIME) AS BIT);
GO
~~START~~
bit
1
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS SMALLDATETIME) AS TINYINT);
GO
~~START~~
tinyint
~~ERROR (Code: 220)~~

~~ERROR (Message: value for domain tinyint violates check constraint "tinyint_check")~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS SMALLDATETIME) AS INT);
GO
~~START~~
int
44926
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS SMALLDATETIME) AS BIGINT);
GO
~~START~~
bigint
44926
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS SMALLDATETIME) AS FLOAT);
GO
~~START~~
float
44925.53958333333
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS SMALLDATETIME) AS DOUBLE PRECISION);
GO
~~START~~
float
44925.53958333333
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS SMALLDATETIME) AS NUMERIC(18,4));
GO
~~START~~
numeric
44925.5396
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS SMALLDATETIME) AS NUMERIC(18,6));
GO
~~START~~
numeric
44925.539583
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.675' AS SMALLDATETIME) AS DECIMAL);
GO
~~START~~
numeric
44926
~~END~~



-- Negative dates, i.e. dates before 1900-01-01
SELECT CAST(CAST('1890-01-01 12:56:50.675' AS SMALLDATETIME) AS BIT);
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: data out of range for smalldatetime)~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS SMALLDATETIME) AS TINYINT);
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: data out of range for smalldatetime)~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS SMALLDATETIME) AS INT);
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: data out of range for smalldatetime)~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS SMALLDATETIME) AS BIGINT);
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: data out of range for smalldatetime)~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS SMALLDATETIME) AS FLOAT);
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: data out of range for smalldatetime)~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS SMALLDATETIME) AS DOUBLE PRECISION);
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: data out of range for smalldatetime)~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS SMALLDATETIME) AS NUMERIC(18,4));
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: data out of range for smalldatetime)~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS SMALLDATETIME) AS NUMERIC(18,6));
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: data out of range for smalldatetime)~~


SELECT CAST(CAST('1890-01-01 12:56:50.675' AS SMALLDATETIME) AS DECIMAL);
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: data out of range for smalldatetime)~~

