SELECT CAST('1' AS CHAR(10)) AS Col1
UNION
SELECT NULL AS Col1
ORDER BY 1
GO
~~START~~
char
<NULL>
1         
~~END~~


SELECT NULL AS Col1
UNION
SELECT CAST('1' AS CHAR(10)) AS Col1
ORDER BY 1
GO
~~START~~
char
<NULL>
1         
~~END~~


SELECT CAST('1' AS NCHAR(10)) AS Col1
UNION
SELECT NULL AS Col1
ORDER BY 1
GO
~~START~~
nchar
<NULL>
1         
~~END~~


SELECT NULL AS Col1
UNION
SELECT CAST('1' AS NCHAR(10)) AS Col1
ORDER BY 1
GO
~~START~~
nchar
<NULL>
1         
~~END~~


SELECT CAST(1 AS BINARY(10)) AS Col1
UNION
SELECT NULL AS Col1
ORDER BY 1
GO
~~START~~
binary
<NULL>
00000000000000000001
~~END~~


SELECT NULL AS Col1
UNION
SELECT CAST(1 AS BINARY(10)) AS Col1
ORDER BY 1
GO
~~START~~
binary
<NULL>
00000000000000000001
~~END~~


SELECT CAST(1 AS CHAR(1)) AS Col1
UNION
SELECT NULL AS Col1
ORDER BY 1
GO
~~START~~
char
<NULL>
1
~~END~~


SELECT CAST('1' AS CHAR(255)) AS Col1
UNION
SELECT NULL AS Col1
ORDER BY 1
GO
~~START~~
char
<NULL>
1                                                                                                                                                                                                                                                              
~~END~~


SELECT CAST('1' AS CHAR(15)) AS Col1
UNION
SELECT CAST('2' AS CHAR(10)) AS Col1
ORDER BY 1
GO
~~START~~
char
1              
2              
~~END~~


SELECT CAST('1' AS CHAR(10)) AS Col1
UNION
SELECT CAST('2' AS CHAR(15)) AS Col1
ORDER BY 1
GO
~~START~~
char
1              
2              
~~END~~


SELECT CAST('1' AS NCHAR(15)) AS Col1
UNION
SELECT CAST('2' AS NCHAR(10)) AS Col1
ORDER BY 1
GO
~~START~~
nchar
1              
2              
~~END~~


SELECT CAST('1' AS NCHAR(10)) AS Col1
UNION
SELECT CAST('2' AS NCHAR(15)) AS Col1
ORDER BY 1
GO
~~START~~
nchar
1              
2              
~~END~~


SELECT CAST(N'ΘЖऌฒ' AS NCHAR(10)) AS Col1
UNION
SELECT NULL AS Col1
ORDER BY 1
GO
~~START~~
nchar
<NULL>
ΘЖऌฒ      
~~END~~


SELECT NULL AS Col1
UNION
SELECT CAST(N'ΘЖऌฒ' AS NCHAR(10)) AS Col1
ORDER BY 1
GO
~~START~~
nchar
<NULL>
ΘЖऌฒ      
~~END~~


SELECT CAST(1 AS BINARY(4)) AS Col1
UNION
SELECT CAST(2 AS BINARY(8)) AS Col1
ORDER BY 1
GO
~~START~~
binary
0000000000000002
0000000100000000
~~END~~


SELECT CAST(1 AS BINARY(4)) AS Col1
UNION
SELECT CAST(2 AS BINARY(8)) AS Col1
ORDER BY 1
GO
~~START~~
binary
0000000000000002
0000000100000000
~~END~~


SELECT CAST('1' AS CHAR(4)) AS Col1
UNION
SELECT CAST(N'ΘЖऌฒ' AS NCHAR(8)) AS Col1
ORDER BY 1
GO
~~START~~
nchar
1       
ΘЖऌฒ    
~~END~~


SELECT CAST(N'ΘЖऌฒ' AS NCHAR(8)) AS Col1
UNION
SELECT CAST('1' AS CHAR(4)) AS Col1
ORDER BY 1
GO
~~START~~
nchar
1       
ΘЖऌฒ    
~~END~~


SELECT CAST('1' AS CHAR(4))
INTERSECT
SELECT CAST('1' AS CHAR(8))
ORDER BY 1
GO
~~START~~
char
1       
~~END~~


SELECT CAST('1' AS CHAR(8))
INTERSECT
SELECT CAST('1' AS CHAR(4))
ORDER BY 1
GO
~~START~~
char
1       
~~END~~


SELECT CAST('1' AS CHAR(4))
EXCEPT
SELECT CAST('1' AS CHAR(8))
ORDER BY 1
GO
~~START~~
char
~~END~~


SELECT CAST('1' AS CHAR(8))
EXCEPT
SELECT CAST('1' AS CHAR(4))
ORDER BY 1
GO
~~START~~
char
~~END~~


-- Multiple Unions --
SELECT CAST('1' AS CHAR(8))
UNION 
SELECT NULL
UNION
SELECT NULL
ORDER BY 1
GO
~~START~~
char
<NULL>
1       
~~END~~


SELECT NULL
UNION 
SELECT CAST('1' AS CHAR(8))
UNION
SELECT NULL
ORDER BY 1
GO
~~START~~
char
<NULL>
1       
~~END~~


SELECT NULL
UNION
SELECT NULL
GO
~~START~~
int
<NULL>
~~END~~


SELECT NULL
UNION ALL
SELECT NULL
GO
~~START~~
int
<NULL>
<NULL>
~~END~~


SELECT NULL
UNION 
SELECT NULL
UNION
SELECT CAST('1' AS CHAR(8))
ORDER BY 1
GO
~~START~~
char
<NULL>
1       
~~END~~


SELECT NULL
UNION 
SELECT NULL
UNION
SELECT CAST(N'ΘЖऌฒ' AS NCHAR(8))
ORDER BY 1
GO
~~START~~
nchar
<NULL>
ΘЖऌฒ    
~~END~~


SELECT CAST('2' AS CHAR(16))
UNION 
SELECT CAST('1' AS CHAR(8))
UNION
SELECT NULL
ORDER BY 1
GO
~~START~~
char
<NULL>
1               
2               
~~END~~


SELECT CAST('2' AS CHAR(16))
UNION 
SELECT CAST('1' AS NCHAR(8))
UNION
SELECT NULL
ORDER BY 1
GO
~~START~~
nchar
<NULL>
1               
2               
~~END~~


SELECT CAST('2' AS NCHAR(16))
UNION 
SELECT CAST('1' AS NCHAR(8))
UNION
SELECT NULL
ORDER BY 1
GO
~~START~~
nchar
<NULL>
1               
2               
~~END~~


SELECT CAST('2' AS NCHAR(16))
UNION ALL
SELECT CAST('1' AS NCHAR(8))
UNION ALL
SELECT NULL
ORDER BY 1
GO
~~START~~
nchar
<NULL>
1               
2               
~~END~~


SELECT NULL
UNION ALL
SELECT NULL
UNION ALL
SELECT CAST(N'ΘЖऌฒ' AS NCHAR(15))
ORDER BY 1
GO
~~START~~
nchar
<NULL>
<NULL>
ΘЖऌฒ           
~~END~~


SELECT CAST('1' AS NCHAR(16))
INTERSECT 
SELECT CAST('1' AS NCHAR(8))
INTERSECT
SELECT CAST('1' AS NCHAR(4))
ORDER BY 1
GO
~~START~~
nchar
1               
~~END~~


SELECT CAST('1' AS NCHAR(16))
INTERSECT 
SELECT CAST('2' AS NCHAR(8))
INTERSECT
SELECT CAST('1' AS NCHAR(4))
ORDER BY 1
GO
~~START~~
nchar
~~END~~


SELECT NULL
INTERSECT 
SELECT NULL
INTERSECT
SELECT CAST(N'ΘЖऌฒ' AS NCHAR(15))
ORDER BY 1
GO
~~START~~
nchar
~~END~~


CREATE TABLE babel3392_nchar_tbl(a NCHAR(20))
GO

INSERT INTO babel3392_nchar_tbl (a)
    SELECT CAST(N'ΘЖऌฒ' AS NCHAR(10)) AS Col1
    UNION
    SELECT NULL AS Col1
    ORDER BY 1
GO
~~ROW COUNT: 2~~


DROP TABLE babel3392_nchar_tbl
GO

-- Should error
WITH babel3392_recursive_cte(a)
AS (
    SELECT NULL
    UNION ALL
    SELECT CAST(a + 'a' AS CHAR(10)) from babel3392_recursive_cte where a != 'aaaaa'
)
SELECT a from babel3392_recursive_cte order by a
GO
~~ERROR (Code: 240)~~

~~ERROR (Message: Types don't match between the anchor and the recursive part in column "a" of recursive query "babel3392_recursive_cte".)~~


-- CASE
CREATE TABLE babel3392_case(a INT)
GO

INSERT INTO babel3392_case (a) VALUES (1), (2), (3)
GO
~~ROW COUNT: 3~~


SELECT CASE a
    WHEN 1 THEN NULL
    WHEN 2 THEN CAST('char' AS CHAR(10))
END
FROM babel3392_case
GO
~~START~~
char
<NULL>
char      
<NULL>
~~END~~


DROP TABLE babel3392_case;
GO

-- COALESCE / ISNULL
SELECT ISNULL(null, cast(N'ΘЖऌฒ' as NCHAR(15)))
GO
~~START~~
nchar
ΘЖऌฒ           
~~END~~


-- BABEL-1874
SELECT NULL
GO
~~START~~
int
<NULL>
~~END~~


SELECT DISTINCT NULL
GO
~~START~~
int
<NULL>
~~END~~


SELECT CAST( 1 AS BIT) AS Col1
UNION 
SELECT DISTINCT NULL AS Col1
ORDER BY 1
GO
~~START~~
bit
<NULL>
1
~~END~~


-- BABEL-4157
SELECT tbl.babel4157_c1 INTO babel4157_tbl FROM (
    SELECT 'string' AS babel4157_c1 
    UNION
    SELECT CAST('varchar' AS VARCHAR(40)) AS babel4157_c1
) AS tbl
GO
~~ROW COUNT: 2~~


SELECT name, max_length FROM sys.columns WHERE name = 'babel4157_c1'
GO
~~START~~
varchar#!#smallint
babel4157_c1#!#40
~~END~~


DROP TABLE babel4157_tbl
GO

-- VALUES
select tbl.babel3392_c1 into babel3392_vals from (
    values (CAST('1' AS CHAR(10))), (CAST(N'ΘЖऌฒ' AS NCHAR(15))), (NULL)
) as tbl(babel3392_c1)
GO
~~ROW COUNT: 3~~


SELECT * FROM babel3392_vals;
GO
~~START~~
nchar
1              
ΘЖऌฒ           
<NULL>
~~END~~


SELECT name, max_length FROM sys.columns WHERE name = 'babel3392_c1'
GO
~~START~~
varchar#!#smallint
babel3392_c1#!#30
~~END~~


DROP TABLE babel3392_vals;
GO
