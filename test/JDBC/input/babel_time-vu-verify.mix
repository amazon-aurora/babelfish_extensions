-- psql
-- behaviour of casting to time in psql
SELECT CAST('2012-02-23' AS TIME)
GO

-- tsql
-- if only date is given as input
-- accepted formats are `mm{-/.}dd{-/.}yyyy`, `yyyy{-/.}mm{-/.}dd`
-- If text month is given then acceptable formats are `dd{-/.}Mon{-/.}yyyy`, `yyyy{-/.}Mon{-/.}dd`, `Mon yyyy dd`, `Mon dd yyyy`, `dd yyyy Mon`, `dd Mon yyyy`, `yyyy Mon dd`, `yyyy dd Mon`
insert into babel_time_vu_prepare_t1 values ('2012   -    02-23')
GO

insert into babel_time_vu_prepare_t1 values ('2012   -    feb -023')
GO

-- expected to fail
insert into babel_time_vu_prepare_t1 values ('2012   -    feb -23   2    :  4     -5')
GO

insert into babel_time_vu_prepare_t1 values ('2012   -    2 -023')
GO

SELECT CAST('   23   -     11   -   2000   ' AS TIME)
GO

SELECT CAST('23-2000-11' AS TIME)
GO

SELECT CAST('11-2000-23' AS TIME)
GO

SELECT CAST('11-23-2000' AS TIME)
GO

SELECT CAST('2000-11-23' AS TIME)
GO

SELECT CAST('2000-23-11' AS TIME)
GO

SELECT CAST('     23     /       11    /     2000     ' AS TIME)
GO

SELECT CAST('23/2000/11' AS TIME)
GO

SELECT CAST('11/2000/23' AS TIME)
GO

SELECT CAST('11/23/2000' AS TIME)
GO

SELECT CAST('2000/11/23' AS TIME)
GO

SELECT CAST('2000/23/11' AS TIME)
GO

SELECT CAST(' 23   -     Nov    -      2000 ' AS TIME)
GO

SELECT CAST('23-2000-Nov' AS TIME)
GO

SELECT CAST('Nov-2000-23' AS TIME)
GO

SELECT CAST('Nov-23-2000' AS TIME)
GO

SELECT CAST('2000-Nov-23' AS TIME)
GO

SELECT CAST('2000-23-Nov' AS TIME)
GO

SELECT CAST('  23    /   Nov    /    2000   ' AS TIME)
GO

SELECT CAST('23/2000/Nov' AS TIME)
GO

SELECT CAST('Nov/2000/23' AS TIME)
GO

SELECT CAST('Nov/23/2000' AS TIME)
GO

SELECT CAST('2000/Nov/23' AS TIME)
GO

SELECT CAST('2000/23/Nov' AS TIME)
GO

SELECT CAST('23        .        11      .     2000' AS TIME)
GO

SELECT CAST('23.2000.11' AS TIME)
GO

SELECT CAST('11.2000.23' AS TIME)
GO

SELECT CAST('11.23.2000' AS TIME)
GO

SELECT CAST('2000.11.23' AS TIME)
GO

SELECT CAST('2000.23.11' AS TIME)
GO

SELECT CAST('   23   . Nov  .  2000  ' AS TIME)
GO

SELECT CAST('23.2000.Nov' AS TIME)
GO

SELECT CAST('Nov.2000.23' AS TIME)
GO

SELECT CAST('Nov.23.2000' AS TIME)
GO

SELECT CAST('2000.Nov.23' AS TIME)
GO

SELECT CAST('2000.23.Nov' AS TIME)
GO

SELECT CAST('jan  12 20 ' AS TIME)
GO

SELECT CAST('jan 2012 12 ' AS TIME)
GO

SELECT CAST('jan 12 2002 ' AS TIME)
GO

SELECT CAST('2012  March 12 ' AS TIME)
GO

SELECT CAST('2012  12 September' AS TIME)
GO

SELECT CAST('12 JuLy 2002 ' AS TIME)
GO

SELECT CAST('12 2002 AprIl' AS TIME)
GO

SELECT CAST('12 decemBer 20 ' AS TIME)
GO

SELECT CAST('Jan-01-2001' AS TIME)
GO

SELECT CAST('Jan-01-2001 01:05:06.289' AS TIME)
GO

SELECT CAST('Jan-2021-01' AS TIME)
GO

SELECT CAST('Jan-2021-01 01:05:06.289' AS TIME)
GO

-- If numeric is specified
-- If `am` or `pm` is specified
SELECT CAST('1' AS TIME)
GO

SELECT CAST('10' AS TIME)
GO

SELECT CAST('102' AS TIME)
GO

SELECT CAST('1020' AS TIME)
GO

SELECT CAST('10202' AS TIME)
GO

SELECT CAST('101022' AS TIME)
GO

SELECT CAST('1010101' AS TIME)
GO

SELECT CAST('10101010' AS TIME)
GO

SELECT CAST('101010101' AS TIME)
GO

SELECT CAST('01 Am' AS TIME)
GO

SELECT CAST('Am 01' AS TIME)
GO

SELECT CAST('13 Am' AS TIME)
GO

SELECT CAST('01 Pm' AS TIME)
GO

SELECT CAST('24 Pm' AS TIME)
GO

SELECT CAST('11:58:59 Pm' AS TIME)
GO

SELECT CAST('2000-11-23 Am' AS TIME)
GO

SELECT CAST('2000-11-23 11:58:59 Pm' AS TIME)
GO

SELECT CAST('1020 2:3' AS TIME)
GO

SELECT CAST('1020 8:3' AS TIME)
GO

SELECT CAST('1020 2:3 Pm' AS TIME)
GO

SELECT CAST('1020 2:3:2.5 Pm' AS TIME)
GO

SELECT CAST('1020 2:3.5 Pm' AS TIME)
GO

SELECT CAST('1020 Pm' AS TIME)
GO

SELECT CAST('1020 Pm 2:3' AS TIME)
GO

SELECT CAST('001200' AS TIME)
GO

SELECT CAST('Jan-2021-01 121200 ' AS TIME)
GO

SELECT CAST('0::' AS TIME);
GO

SELECT CAST('23:59:' AS TIME)
GO

SELECT CAST('24:00:00' AS TIME);
GO

SELECT CAST('1::' AS TIME)
GO

SELECT CAST(':1:' AS TIME)
GO

SELECT CAST('::1' AS TIME)
GO

SELECT CAST('23:59:' AS TIME)
GO

SELECT CAST('24:00:' AS TIME)
GO

SELECT CAST('01 21:56:38.300' AS TIME)
GO

SELECT CAST('01-01 21:56:38.300' AS TIME)
GO

SELECT CAST('10:1:1.1111111111' AS TIME)
GO

-- The output should be "10:01:01.1111111"
SELECT CAST('10:1:1.111111111' AS TIME)
GO

-- different kind of input
SELECT CAST('1998-02-23T14:23:05' AS time)
GO

SELECT CAST('1998-02-23 T14:23:05' AS time)
GO

SELECT CAST('1998-23-3T 14:23:05' AS time)
GO

SELECT CAST('1998-23-3T14:23:05' AS time)
GO

SELECT CAST('1-23-2000T14:23:05' AS time)
GO

SELECT CAST('1-2358-20T14:23:05' AS time)
GO

SELECT CAST('1998-Jan-23T14:23:05' AS time)
GO

SELECT CAST('19-jULY-2000T14:23:05' AS time)
GO

SELECT CAST('1998-2-jULYT14:23:05' AS time)
GO

SELECT CAST('19-2000-jULYT14:23:05' AS time)
GO

SELECT CAST('JAn-23-1900T14:23:05' AS time)
GO

SELECT CAST('JAn-2300-19T14:23:05' AS time)
GO

SELECT CAST('1998-02-23t14:23:05' AS time)
GO

SELECT CAST('1998-02-23 t14:23:05' AS time)
GO

SELECT CAST('1998-02-23t 14:23:05' AS time)
GO

SELECT CAST('1998-02-23T4:23:05' AS time)
GO

SELECT CAST('1998-02-23T14:25' AS time)
GO

SELECT CAST('1998-02-23t14:23:05 pm' AS time)
GO

SELECT CAST('19-02-23t14:23:05 pm' AS time)
GO

SELECT CAST('19985-02-23t14:23:05 pm' AS time)
GO

SELECT CAST('1998-02-23num14:23:05' AS time)
GO

-- casting to particular round off, valid in range of [0-7]
SELECT CAST('2015-03-19 01:05:06.289' AS TIME(0))
GO

SELECT CAST('2015-03-19 01:05:06.289' AS TIME(1))
GO

SELECT CAST('2015-03-19 01:05:06.289' AS TIME(2))
GO

SELECT CAST('2015-03-19 01:05:06.289' AS TIME(3))
GO

SELECT CAST('2015-03-19 01:05:06.289' AS TIME(4))
GO

SELECT CAST('2015-03-19 01:05:06.289' AS TIME(5))
GO

SELECT CAST('2015-03-19 01:05:06.289' AS TIME(6))
GO

SELECT CAST('2015-03-19 01:05:06.289' AS TIME(7))
GO

-- multiple casting
SELECT CAST(CAST('2000-11-23' AS DATETIME) AS TIME)
GO

select CAST(CAST('00:00:00.000' AS time) AS datetime)
go

select CAST(CAST('2000-11-23' AS time) AS datetime)
go
select CAST(CAST('23:59:59.123456' AS time) AS datetime)
go

select CAST(CAST('1900-05-06 23:59:29.998' AS datetime) AS time)
go

select CAST(CAST('2050-05-06 00:00:00' AS datetime) AS time)
go

select CAST(CAST('2050-05-06 23:59:29.998' AS datetime) AS time)
go

-- These particular cases are failing in SQL Server but passing in bbf
-- case where if we mention input has no milli seconds mentioned after (".")
-- and cases when valid offset("+-") and for valid range
SELECT CAST('2012   -    02   -    23     2    :      3       :       8    .' AS TIME)
GO

SELECT CAST('2012   -    02   -    23     2    :      3       :       8    .' AS TIME(0))
GO

SELECT CAST('2012   -    02   -    23     2    :      3       :       8    .          876    +   8' AS TIME)
GO

SELECT CAST('2012   -    02   -    23     2    :      3       :       8    .          876    -   8' AS TIME)
GO

SELECT CAST('2012   -    02   -    23     2    :      3       :       8    .          876    +   8' AS TIME(0))
GO

SELECT CAST('2012   -    02   -    23     2    :      3       :       8    .          876    -   8' AS TIME(0))
GO

SELECT CAST('2012-      02-     23     02      :     03  :     00        +       8' AS TIME)
GO

SELECT CAST('2012   -    FeB   -    23     2    :      3       :       8    .' AS TIME)
GO

SELECT CAST('2012   -    FeB   -    23     2    :      3       :       8    .' AS TIME(0))
GO

SELECT CAST('2012   -    FeB   -    23     2    :      3       :       8    .          876   + 8' AS TIME)
GO

SELECT CAST('2012   -    FeB   -    23     2    :      3       :       8    .          876   - 8' AS TIME)
GO

SELECT CAST('2012   -    FeB   -    23     2    :      3       :       8    .          876   + 8' AS TIME(0))
GO

SELECT CAST('2012   -    FeB   -    23     2    :      3       :       8    .          876   - 8' AS TIME(0))
GO

-- case where input is of format 'mm yyyy dd hhmmss.ss'
SELECT CAST('Jan   2021   01 010506.289' AS TIME)
GO

SELECT CAST('0012:00' AS TIME)
GO

-- if only offset is mentioned
SELECT CAST('+02' AS TIME);
GO

SELECT CAST('+02:0' AS TIME);
GO

SELECT CAST('2:3 +02:0' AS TIME);
GO

SELECT CAST('2:3:55 +2:0' AS TIME);
GO

SELECT CAST('2:3.3 +02:30' AS TIME);
GO

SELECT CAST('2:3:3.4444 +2:30' AS TIME);
GO

SELECT CAST('1004-23-1 +02:00' AS TIME);
GO

SELECT CAST('1004-02-13 2:3+02:00' AS TIME);
GO

SELECT CAST('1004 1 DEC 2:3.5 +02:00' AS TIME);
GO

SELECT CAST('1004 1 DEC 2:3:3.5 +02:00' AS TIME);
GO

SELECT CAST('2:3:3.5 23-11-2000 +02:00' AS TIME);
GO

SELECT CAST('1004-1-23 8:9 -8:00' AS TIME);
GO

SELECT CAST('1-23-1000 8:9 -8:00' AS TIME);
GO

SELECT CAST('23-1-1004 8:9 -8:00' AS TIME);
GO

SELECT CAST('23-1004-1 8:9 -10:0' AS TIME)
GO

SELECT CAST('1004-July-23 8:9 -8:00' AS TIME);
GO

SELECT CAST('Nov-23-1000 8:9 -8:00' AS TIME);
GO

SELECT CAST('23-Apr-1004 8:9 -8:00' AS TIME);
GO

SELECT CAST('23-1004-Mar 8:9 -10:0' AS TIME)
GO

SELECT CAST('1004 DEC 1 2:3:3.5 +02:00' AS TIME);
GO

SELECT CAST('DEC 1 2005 2:3:3.5 +02:00' AS TIME);
GO

SELECT CAST('DEC 2005 25 2:3:3.5 +02:00' AS TIME);
GO

SELECT CAST('25 DEC 2005  2:3:3.5 +02:00' AS TIME);
GO

SELECT CAST('25 2005 November  2:3:3.5 +02:00' AS TIME);
GO

-- Invalid dates has been passed as an input
SELECT CAST('Jan-0000-01' AS TIME)
GO

SELECT CAST('Jan-2021-34' AS TIME)
GO

SELECT CAST('Month-2021-01' AS TIME)
GO

-- casting to time from date shouldn't be allowed
select CAST(CAST('2020-03-15' AS date) AS time);
GO

-- out of range for time datatype should throw error
SELECT CAST('2015-03-19 01:05:06.   289' AS TIME(8))
GO

-- case where the yyyy is not able to figure out from given input which contains yy
SELECT CAST('3-01-jan 01:05:06.289' AS TIME)
GO

-- if given hh:mmmm
SELECT CAST('00:1200' AS TIME)
GO

--if given yyyymmdd as input
SELECT CAST('2012jan01' AS TIME)
GO

SELECT CAST('Jan   2021    010506.289' AS TIME)
GO

SELECT CAST('Jan   2021   01 01   05    06    .    289' AS TIME)
GO

-- if only offset is mentioned
SELECT CAST('+02' AS TIME);
GO

-- if invalid dates has been given then conversion shouldn't succeed
SELECT CAST('0000-00-00' AS TIME)
GO

SELECT CAST('0-0-0' AS TIME)
GO

SELECT CAST('00-00-0000' AS TIME)
GO

SELECT CAST('00-0-0' AS TIME)
GO

SELECT CAST('0-0-00' AS TIME)
GO

Select CAST('2001-04-022 16:23:51.766890 +12:00' AS TIME)
GO

Select CAST('02001-04-22 16:23:51.766890 +12:00' AS TIME)
GO

SELECT CAST('Jan-2021-01 121200 -1' AS TIME)
GO

SELECT * from babel_TIME_vu_prepare_t1
GO

SELECT CAST(a as time) from babel_TIME_vu_prepare_t1
GO

SELECT babel_TIME_vu_prepare_f1()
GO

exec babel_TIME_vu_prepare_p1
GO

SELECT * FROM babel_TIME_vu_prepare_v1
GO
