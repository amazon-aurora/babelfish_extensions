-- tsql
exec sp_babelfish_createExtension 'create extension pg_stat_statements with schema sys version "1.9"';
go
select * from pg_extension where extname = 'pg_stat_statements'
go

-- psql
SET sys.pg_stat_statements.track = 'none';
SELECT sys.pg_stat_statements_reset();
go
-- tsql
SELECT dbid, toplevel, query, calls, rows, plans from pg_stat_statements where queryid != 0 ORDER BY query COLLATE "C";
go
exec sp_babelfish_createExtension 'alter extension pg_stat_statements update to "1.10"'
go
select extname, extversion from pg_extension where extname = 'pg_stat_statements'
go
-- throw an error if user tries to alter schema
exec sp_babelfish_createExtension 'alter extension pg_stat_statements set schema sys'
go
-- throw an error if user tries to Add/Drop objects in extension
create table demo(A int)
go
exec sp_babelfish_createExtension 'alter extension pg_stat_statements add table demo'
go
drop table demo
go
-- throw an error if more than one statement is passed
exec sp_babelfish_createExtension 'create extension pg_stat_statements with schema sys; create extension pg_stat_statements';
go
exec sp_babelfish_createExtension 'drop extension pg_stat_statements';
go
-- throw an error if user creates anything other than allowed extensions
exec sp_babelfish_createExtension 'create extension pg_stat_statement with schema sys';
go
exec sp_babelfish_createExtension 'create extension pg_stat_statements with schema sys';
go
exec sp_babelfish_createExtension 'drop extension pg_stat_statements';
go
select * from pg_stat_statements
go